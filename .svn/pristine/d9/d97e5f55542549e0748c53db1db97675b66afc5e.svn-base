<ion-view hide-back-button="true"><!-- view-title=""-->
	<ion-nav-title>
	    <div class="bar bar-header header">
	    	<button class="button button-clear button-positive drop_out" ng-click="goBack()"><i class="icon ion-ios-arrow-left"></i></button>
	    	<!--<button ng-click="$ionicGoBack()" class="button back-button buttons button-clear header-item" style="opacity: 0;"><i class="icon ion-ios-arrow-left"></i> -->
			<h1 class="title ios_title">工单详情</h1>
	    </div>
    </ion-nav-title>
  <ion-content class="detail_content">
  	<div class="review_list">
  		<ul class="review_list_title">
  			<li class="review_list_header">
  				<p>基本信息</p>
  				<p><span class="ion-ios-arrow-down"></span></p>
  			</li>
  		</ul>
  		<div class="review_list_content no-border">
  			<p>工单号：{{dataDetail.orderBase.code}}</p>
  			<p>进厂时间：{{dataDetail.orderBase.createTime}}</p>
  			<p>工单状态：{{dataDetail.orderBase.statusName}}</p>
  			<p>工单类别：{{dataDetail.orderBase.jobTypeName}}</p>
  			<p>维修类别：{{dataDetail.orderBase.repairTypeName}}</p>
  			<p>车牌号：{{dataDetail.orderBase.carLicense}}</p>
  			<p>车辆类型：<span>{{dataDetail.orderBase.operationType}}</span></p>
  			<p>车型：<span>{{dataDetail.orderBase.carModelName}}</span></p>
  			<p>上次保养里程：{{dataDetail.orderBase.lastMaintenanceMileage}}km</p>
  			<p>上次进厂里程：{{dataDetail.orderBase.lastMileage}}km</p>
  			<p>进厂里程：{{dataDetail.orderBase.mileage}}km</p>
  			<p>送修人姓名：{{dataDetail.orderBase.sendPeopleName}}</p>
  			<p ng-click="callPhone(dataDetail.orderBase.sendPeoplePhone)">送修人电话：
  				<span class="review_list_price">{{dataDetail.orderBase.sendPeoplePhone}}</span>
  				<i class="review_list_price icon ion-ios-telephone-outline" ></i>
  			</p>
  			<p>服务门店：{{dataDetail.orderBase.shortName}}</p>

  			<p class="detail_content_phone">
  				门店电话：
  				<span class="">{{dataDetail.orderBase.servicePhone}}</span>
  			</p>
        <p ng-if="dataDetail.orderBase.refuseNote!=''">驳回原因：{{dataDetail.orderBase.refuseNote}}</p>
  			<p>备注：{{dataDetail.orderBase.note}}</p>
  			<!--<p ng-if="dataDetail.orderBase.operationStatus == 003 || dataDetail.orderBase.operationStatus == 008">驳回原因：{{dataDetail.orderBase.refuseNote}}</p>-->
  		</div>
  	</div>
  	<div class="review_list">
  		<ul class="review_list_title">
  			<li class="review_list_header">
  				<p>维修项目</p>
  				<p><span class="ion-ios-arrow-down"></span></p>
  			</li>
  		</ul>
  		<div ng-if="dataDetail.projectList.length == 0" style="padding: 10px;">
  			暂无数据~~
  		</div>
  		<div class="review_list_content no-border no-padding">
  			<div ng-repeat="items in dataDetail.projectList" class="color-font-{{items.changeType}}">
  				<div class="maintenance_items" ng-if="items.statusName == '待完工' || items.statusName == '已完工' || items.statusName == '待总检' || items.statusName == '异常单'|| items.statusName == '已结算'|| items.statusName == '待结算'">
            		<span class="item_inde">{{$index+1}}</span>
	  				<p>
	  					<span>{{items.projectName}}</span>
	  					<br />
	  					<span>工时费：<span class="review_list_price">¥{{items.projectUnitTotalMoney}}</span></span>&nbsp;&nbsp;&nbsp;&nbsp;
	  					<span>维修技师：<span class="review_list_price">{{items.RepairOrderProjectUserNameStr}}</span></span>
	  				</p>
	  				<p>

	  				</p>
	  			</div>
	  			<div class="maintenance_items" ng-if="items.statusName == '已创建' || items.statusName == '已驳回' || items.statusName == '待审核' || items.statusName == '待派工'">
            		<span class="item_inde">{{$index+1}}</span>
	  				<p>
	  					<span>{{items.projectName}}</span>
	  					<br />
	  					<span>工时：{{items.projectManHour}}</span>
	  				</p>
	  				<p>
	  					<span>单价：<span class="review_list_price">¥{{items.projectUnitPrice}}</span></span>
	  					<br />
	  					<span>工时费：<span class="review_list_price">¥{{items.projectUnitTotalMoney}}</span></span>
	  				</p>
	  			</div>
	  			<div class="maintenance_items_hr"></div>
  			</div>
  			<div>
	  			<p class="review_list_price subtotal">小计：¥ {{projectPrice}}</p>
	  		</div>
  		</div>
  	</div>
  	<div class="review_list">
  		<ul class="review_list_title">
  			<li class="review_list_header">
  				<p>维修材料</p>
  				<p><span class="ion-ios-arrow-down"></span></p>
  			</li>
  		</ul>
  		<div ng-if="dataDetail.goodsList.length == 0" style="padding: 10px;">
  			暂无数据~~
  		</div>
  		<div class="review_list_content no-border no-padding">
  			<div ng-repeat="items in dataDetail.goodsList" class="color-font-{{data.changeType}}">
	  			<div class="maintenance_items_padding">
  					<span class="maintenance_name">{{items.goodsName}}&nbsp;&nbsp;&nbsp;&nbsp;{{items.goodsStyle}}&nbsp;&nbsp;&nbsp;&nbsp;{{items.brandName}}</span>
  				</div>
  				<div class="maintenance_items_padding">
  					<span class="maintenance_name">数量：{{items.goodsNumber}}&nbsp;&nbsp;&nbsp;&nbsp;单价：<span class="review_list_price">¥{{items.goodsUnitPrice}}</span>&nbsp;&nbsp;&nbsp;&nbsp;金额：<span class="review_list_price">{{items.totalMoney}}</span></span>
  					<span>&nbsp;&nbsp;&nbsp;&nbsp;{{items.purchaseTypeCN}}</span>
  				</div>
	  			<div class="maintenance_items_hr"></div>
  			</div>
  			<div>
	  			<p class="review_list_price subtotal">小计：¥ {{goodsPrice}}</p>
	  		</div>
  		</div>
  	</div>
  	<div class="review_list">
  		<ul class="review_list_title">
  			<li class="review_list_header">
  				<p>图片</p>
  				<p><span class="ion-ios-arrow-down"></span></p>
  			</li>
  		</ul>
			<div ng-if="dataDetail.imageList.length==0" style="padding: 10px;">
  			暂无图片~~
  		</div>
  		<div class="review_list_content no-border review_list_img_wrap">
  			<div class="review_list_img" ng-repeat="data in dataDetail.imageList track by $index" ng-if="data.imgUrl!=null">
          <img src="{{data.imgUrl}}" ng-click="showBigImage('{{data.imgUrl}}','{{data.imgNote}}')" />
          <p class="textAlignCenter" ng-bind="data.imgNote"></p>
        </div>
  		</div>
  	</div>
    <div class="review_list">
      <a href="#/operation_log/{{dataDetail.orderBase.id}}">
        <ul class="review_list_title">
          <li class="review_list_header">
            <p>操作日志</p>
            <p><span class="ion-ios-arrow-right"></span></p>
          </li>
        </ul>
      </a>
    </div>
  	<div class="review_list">
  		<div class="review_list_content no-border no-padding">
  			<div class="maintenance_items">
  				<p>
  					<span>代办费：<span class="review_list_price">¥{{dataDetail.otherPrice.agencyFee}}</span></span>
  				</p>
  				<p>
  					<span>检测费：<span class="review_list_price">¥{{dataDetail.otherPrice.testingFee}}</span></span>
  				</p>
  			</div>
  			<!--<div class="maintenance_items_hr"></div>-->
  			<div class="maintenance_items paddingTop0">
  				<p>
  					<span>拖车费：<span class="review_list_price">¥{{dataDetail.otherPrice.towingFee}}</span></span>
  				</p>
  				<p>
  					<span>其他费：<span class="review_list_price">¥{{dataDetail.otherPrice.otherFee}}</span></span>
  				</p>
  			</div>
  		</div>
  	</div>
	<p class="bgf billing_entry_center_bottom_left">小计：¥{{dataDetail.otherPrice.towingFee*1+dataDetail.otherPrice.agencyFee*1+dataDetail.otherPrice.testingFee*1+dataDetail.otherPrice.otherFee*1}}</p>

  </ion-content>
  <com-image-box></com-image-box>
  <div class="PriceDetails" ng-show="PriceDetails">
  	<p>费用合计：<span class="review_list_price">¥{{dataDetail.otherPrice.totalMoney}}</span>
  		 = 工时费：<span class="review_list_price">¥{{projectPrice}}</span> +
  		 材料费：<span class="review_list_price">¥{{goodsPrice}}</span> +
  		 附加费用：<span class="review_list_price">¥{{dataDetail.otherPrice.agencyFee * 1 + dataDetail.otherPrice.testingFee * 1 + dataDetail.otherPrice.towingFee * 1 + dataDetail.otherPrice.otherFee * 1}}</span>
  	</p>
  </div>
  <div class="footer_bars">
		<p ng-click="showPriceDetails()">总计：<span class="review_list_price">¥{{dataDetail.otherPrice.totalMoney}}</span><i ng-class="PriceDetailsClassName"></i></p>
		<!-- 已创建：001-->
		<a href="" ng-if="dataDetail.orderBase.operationStatus==001">
			<button class="button button-outline review_list_btn_turnDown review_list_btn" ng-click="audit(dataDetail.orderBase.id)">提交审核</button>
		</a>
		<a href="" ng-if="dataDetail.orderBase.operationStatus==001">
			<button class="button button-outline review_list_btn_turnDown review_list_btn" ng-click="alter(dataDetail.orderBase.id)">修改</button>
		</a>

		<!-- 待审核：002 || 已驳回：003 || 待总检：007 || 异常单：007-->

		<a href="" ng-if="dataDetail.orderBase.operationStatus==002 || dataDetail.orderBase.operationStatus==003 || dataDetail.orderBase.operationStatus==007 || dataDetail.orderBase.operationStatus==008 ">
			<button class="button button-outline review_list_btn_turnDown gray review_list_btn" ng-click="withdraw(dataDetail.orderBase.operationStatus, dataDetail.orderBase.id)">撤回</button>
		</a>

		<!-- 待派工：004-->

		<a href="#/sendWork/{{dataDetail.orderBase.id}}/{{dataDetail.orderBase.code}}/{{dataDetail.orderBase.carLicense}}" ng-if="dataDetail.orderBase.operationStatus==004">
			<button class="button button-outline review_list_btn_turnDown review_list_btn">派工</button>
		</a>
		<a href="" ng-if="dataDetail.orderBase.operationStatus==004">
			<button class="button button-outline review_list_btn_turnDown review_list_btn" ng-click="alter(dataDetail.orderBase.id)">修改</button>
		</a>

		<!-- 待完工：005-->

		<a href="#/sendWork/{{dataDetail.orderBase.id}}/{{dataDetail.orderBase.code}}/{{dataDetail.orderBase.carLicense}}" ng-if="dataDetail.orderBase.operationStatus==005">
            <button class="button button-outline review_list_btn_turnDown review_list_btn">重派</button>
        </a>
        <a href="javascript: void(0)" ng-if="dataDetail.orderBase.operationStatus==005" ng-click="alter(dataDetail.orderBase.id)">
            <button class="button button-outline review_list_btn_turnDown review_list_btn">修改</button>
        </a>
        <a href="javascript: void(0)" ng-if="dataDetail.orderBase.operationStatus==005" ng-click="finished(dataDetail.orderBase.id)">
            <button class="button button-outline review_list_btn_turnDown review_list_btn">完工</button>
        </a>

        <!-- 已完工：006-->
        <a href="#/upload_photos/{{dataDetail.orderBase.id}}/{{dataDetail.orderBase.operationStatus}}" ng-if="dataDetail.orderBase.operationStatus==006">
            <button class="button button-outline review_list_btn_turnDown review_list_btn">提交总检</button>
        </a>
	</div>
</ion-view>
